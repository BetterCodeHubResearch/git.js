<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.4.2/jquery.min.js"></script>
    <script src="../../lib/jsgit-client.js"></script>
    <script src="repo-viewer.js"></script>
  </head>
  <body>
    <h1>Git.JS</h1>
    
    <table>
      <tr>
        <td style="vertical-align: top;">
          <form id="repo">
            username: <input type="text" id="username" value="danlucraft"><br>
            password: <input type="password" id="password"><br>
            repo:     <input type="text" id="reponame" value="test-repo1"><br>
            <input type="submit" text="Clone" id="clone-button">
          </form>
          <br>
          <form id="refs">
            <select name="refs" id="refs-list">
              <option value=""></option>
            </select>
          </form>
          <br>
          <div id="remote-lines">
            
          </div>
        </td>
        <td>
          <div id="main">
            <ul id="objects">
            </ul>
          </div>
        </td>
      </tr>
    </table>
    
    <script type="text/javascript">
      $(document).ready(function() {
        $("form#repo").submit(function(e) {
          e.preventDefault()
          var username = $("input#username").attr("value"),
              password = $("input#password").attr("value"),
              reponame = $("input#reponame").attr("value")
          RepoViewer.demo(username, reponame, password)
        })
        
        $("select#refs-list").change(function(e) {
          e.preventDefault()
          var refToFetch = $("select#refs-list").val()
          var origin = RepoViewer.repo.getRemotes()["origin"]
          origin.fetchRef(RepoViewer.repo.getRefs()[refToFetch], function(remoteLines, newObjects) {
            RepoViewer.displayRemoteLines(remoteLines)
            RepoViewer.displayObjects(newObjects)
          })
        })
      })
    </script>
  </body>
</html>